## Сервис-генератор отчета

#### Установка

Сперва необходимо склонировать репозиторий и установить все необходимые зависимости

    git clone https://github.com/Blthrst/generator-service
    npm i yarn 
    yarn install

#### Подготовка к запуску

Сначала стоит убедиться, что у Вас запущены `postgresql` и `redis`.

Далее нужно настроить переменные окружения. Для этого переименуйте файл `.env.example` в `.env` и подставьте свои значения переменных окружения. 

После этого нужно подготовить БД. Для этого создайте БД `generator` (или ту, имя которой соответствует Вашему значению `MIKRO_ORM_CSTMR_DB`) и запустите миграции:
    
    yarn run m:up

Затем настройте переменные окружения `BASE_URL` или `DOMAIN` (на Ваш выбор), чтобы сервис мог создавать ссылки для скачивания.

При необходимости можно изменить значение `GEN_MAX_REQUESTS` (отвечает за лимит запросов к сервису-заказчику).

#### Запуск

После совершения всех действий можно запустить сервис-генератор с помощью ввода в терминал `yarn run start`.

#### API

  По умолчанию корневой URL выглядит так: `http://localhost:3000`.

 **/tasks**
  - GET /tasks?id - отдаёт статус задачи с указанным идентификатором
  - POST /tasks/new - создаёт задачу на генерацию отчёта

 **/downloads**
  - GET /downloads/:id - отправляет клиенту сгенерированный отчет (`.xlsx`).

